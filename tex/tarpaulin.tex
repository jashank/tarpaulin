\documentclass{book}

\def\mytitle{The Rust Programming Language}
\def\myauthor{The Rust Project Developers}

%%%
%%% Pull in packages, in no particularly relevant order.
%%%
\usepackage{alltt}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{color}
\usepackage{fancyhdr}
\usepackage{geometry}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{hyphenat}
\usepackage{makeidx}
\usepackage{multicol}
\usepackage{refstyle}
\usepackage{shorttoc}
\usepackage{sectsty}
\usepackage[nottoc]{tocbibind}
\usepackage[normalem]{ulem}
\usepackage{wrapfig}

%%%
%%% A range of very small tweaks.
%%%

%% Disable maketitle
\def\maketitle{}

%% Configure paragraph skip dimensions.
\setlength{\parskip}{\smallskipamount}
\setlength{\parindent}{0pt}

%% Enable index generation.
\makeindex

%% Chapter headings
\allsectionsfont{\normalfont\sffamily\bfseries}

%% Fancy headers
\fancypagestyle{book}{%
  \fancyhf{}%
  \fancyfoot[C]{%
    \rule[4pt]{1cm}{.1pt}%
    \hspace{10pt}%
    \thepage%
    \hspace{10pt}%
    \rule[4pt]{1cm}{.1pt}%
}}
\pagestyle{book}

%% TOC
\makeatletter
  \newcommand\shorttocname{Short Table of Contents}
\renewcommand\contentsname{Table of Contents}
\newcommand{\my@toc}{%
  \pdfbookmark[1]{\shorttocname}{shorttoc}%
  \shorttoc{\shorttocname}{0}%
  \cleardoublepage{}%
  \pdfbookmark[1]{\contentsname}{toc}%
  \tableofcontents{}%
}
\makeatother

%% thank pandoc
\usepackage{listings}
\usepackage{longtable,booktabs}
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}


%$if(verbatim-in-note)$
\usepackage{fancyvrb}
\VerbatimFootnotes % allows verbatim text in footnotes
%$endif$
%$if(links-as-notes)$
% Make links footnotes instead of hotlinks:
\renewcommand{\href}[2]{#2\footnote{\url{#1}}}
%$endif$


%%%
%%% Page, Feature and Style Configuration
%%%
%% hyperref
\hypersetup{unicode=true,
  bookmarks=true,
  bookmarksnumbered=false,
  bookmarksopen=false,
  breaklinks=false,
  pdfborder={0.7 0.2 0},
  backref=false,
  colorlinks=false,
  pdftitle={\mytitle},
  pdfauthor={\myauthor}}

%% geometry and crop
\geometry{verbose,
  paperheight=230mm,
  paperwidth=180mm,
  lmargin=25mm, rmargin=25mm,
  tmargin=12mm, bmargin=12mm,
  headheight=14pt,
  headsep=1cm,
  footskip=1cm}
\usepackage[cam,info,axes,a4,center]{crop}
%\geometry{a4paper,margin=1in,headheight=14pt,headsep=1cm,footskip=1cm}

%% fontspec
\usepackage{fontspec}
\usepackage[protrusion=true,expansion]{microtype}

\defaultfontfeatures{Ligatures=TeX}

\setmainfont[Path=../fonts/,%
             ItalicFont={Heuristica-Italic.otf},%
             BoldFont={SourceSerifPro-Bold.otf},%
             BoldItalicFont={Heuristica-BoldItalic.otf}%
        ]{SourceSerifPro-Regular.otf}

\setsansfont[Path=../fonts/,Scale=MatchUppercase,%
             ItalicFont={FiraSans-RegularItalic.otf},%
             BoldFont={FiraSans-Medium.otf},%
             BoldItalicFont={FiraSans-MediumItalic.otf}%
        ]{FiraSans-Regular.otf}

\setmonofont[Path=../fonts/,Scale=0.857142,%
        ]{SourceCodePro-Regular.otf}
\usepackage{upquote}

\makeatletter
\def\my@titlepage{
  \begin{titlepage}%
    \vspace*{\fill}\begin{center}%
      {\fontsize{48pt}{64pt}%
        \includegraphics[width=.25\linewidth]{rust-logo-512x512-blk.png}\\%
        \vspace*{1em}
        \textsf{\bfseries The Rust}\\
        \textsf{\bfseries Programming}\\ 
        \textsf{\bfseries Language}\\%
      }%
    \end{center}\vspace*{\fill}%
  \end{titlepage}
}

\def\my@copyrightpage{
  \clearpage{}
\thispagestyle{empty}
  \newpage{}
\thispagestyle{empty}

\begingroup
\footnotesize
\parindent 0pt
\parskip \baselineskip
Copyright \textcopyright{} 2011--2015 \myauthor.  Licensed under the
Apache License, Version 2.0 or the MIT license, at your option.  This
file may not be copied, modified, or distributed except according to
those terms.

``Rust'', ``Cargo'', the Rust logo, and the Cargo logo are trademarks
of the Mozilla Foundation.

The paper used in this publication may meet the minimum requirements
of the American National Standard for Information Sciences ---
Permanence of Paper for Printed Library Materials, ANSI Z39.48--1984.

\begin{center}
10 9 8 7 6 5 4 3 2 1
\end{center}

\begin{center}
\begin{tabular}{ll}
Rust 1.0.0: & 15 May 2015 \tabularnewline
Rust 1.1.0: & 25 June 2015 \tabularnewline 
Rust 1.2.0: & 7 August 2015 \tabularnewline
Rust 1.3.0: & 17 September 2015 \tabularnewline
Rust 1.4.0: & 29 October 2015 \tabularnewline
\end{tabular}
\end{center}

\vfill

\begin{center}
This book was typeset with \LaTeX{}, in\\
\textrm{Adobe Source Serif Pro},
\textrm{\textit{Heuristica}},
\textsf{Fira Sans}, and 
\texttt{Adobe Source Code Pro}. \\
This version was generated on \today{}, and corresponds to Rust \input{version}
\end{center}

\vspace*{2\baselineskip}

\endgroup
\clearpage
}

\begin{document}
\makeatletter
\my@titlepage
\my@copyrightpage
\my@toc

\part{The Rust Programming Language}
\include{book/book}
% ~330 pages

\part{The Rustonomicon;\\ or, the Advanced Rust Programming Language}
\include{nomicon/nomicon}
% ~110 pages

\part{Language Reference}
\include{langref/langref}
% ~90 pages

\part{Standard Library Reference}

% XXX Someday:
%\part{Style Guide}
%\include{style/style}

\part{Tools Reference}

\end{document}
